+function(t){"use strict";function e(e,o,a){var s=t(this);if(!navigator.getBattery)return console.warn("navigator.gerBattery API's not supported browser."),s;var n=s.data("pure.pureBattery"),i=t.extend({},r.DEFAULTS,s.data,"object"==typeof e&&e);if(n||s.data("pure.pureBattery",n=new r(this,i)),"string"==typeof e){var p=n[e](o,a);return void 0==p?s:p}}var r=function(e,r){this.options=r,this.$element=t(e),this.orginalBatteryInfo=null,this.testBatteryInfo=null,this.makeBattery(),this.addBatteryEvent()};r.VERSION="0.1-beta",r.DEFIN={progressBarId:"pure-battery-progressbar",levelValueId:"pure-battery-value-span",dangerCallbackEvent:"battery-danger",StableCallbackEvent:"battery-stable"},r.DEFAULTS={test:!1,width:"50px",height:"22px",fontColor:"#ffffff",borderColor:"#333333",backgroundColor:"#555555",chargingIcon:"glyphicon-flash",warningLevel:50,dangerLevel:30,progressStep:5},r.prototype.makeBattery=function(){var e=this.$element,o=this.options;e.prop("style").width||e.css({width:o.width}),e.prop("style").height||e.css({height:o.height}),o.width=e.prop("style").width,o.height=e.prop("style").height;var a=t("<div></div>").css({width:"100%",height:"100%",display:"inline-block"}).appendTo(e),s=t("<div></div>").addClass("progress pure-battery-progress").css({width:"100%",height:"100%"}).css({"background-color":o.backgroundColor,"border-color":o.borderColor}).appendTo(a);t("<div></div>").attr("id",r.DEFIN.progressBarId).attr("role","progressbar").attr("aria-valuemin","0").attr("aria-valuemax","100").addClass("progress-bar").css({width:"100%"}).appendTo(s)},r.prototype.updateBattery=function(){var t=this.$element,e=this.options;t.css({width:e.width}),t.css({height:e.height}),t.find(".pure-battery-progress").css({"background-color":e.backgroupColor,"border-color":e.borderColor})},r.prototype.updateBatteryStatus=function(e){var o=this.$element,a=this.options;a.test?(null==this.testBatteryInfo&&(this.testBatteryInfo=this.orginalBatteryInfo),e=t.extend({},this.testBatteryInfo,e),this.testBatteryInfo=e):e?this.orginalBatteryInfo=e:e=this.orginalBatteryInfo;var s=e.charging,n=Math.round(100*e.level),i=n;a.progressStep>0&&(i=Math.floor(n/a.progressStep)*a.progressStep,0>=i&&(i=5),n>=100&&100>i&&(i=100)),e.viewLevel=n;var p=o.find("#"+r.DEFIN.progressBarId);p.removeClass(function(t,e){return(e.match(/(^|\s)progress-bar-\S+/g)||[]).join(" ")}),p.find("#"+r.DEFIN.levelValueId).remove();var l=t("<span></span>").attr("id",r.DEFIN.levelValueId).css({color:a.fontColor});s?(p.addClass("progress-bar-info"),p.append(l.addClass("glyphicon "+a.chargingIcon))):p.addClass(n>a.warningLevel?"progress-bar-success":n>a.dangerLevel?"progress-bar-warning":"progress-bar-danger"),(!s||s&&100>n)&&p.append(l.html(n+"%")),p.css({width:i+"%"}),this.eventTrigger(e)},r.prototype.addBatteryEvent=function(){var t=this,e=this.options;navigator.getBattery().then(function(r){t.orginalBatteryInfo=r,t.updateBatteryStatus(r);var o=function(){e.test||t.updateBatteryStatus(r)};r.addEventListener("chargingchange",o,!1),r.addEventListener("levelchange",o,!1)})},r.prototype.eventTrigger=function(e){var o=this.options,a=null;a=t.Event(!e.charging&&e.viewLevel<=o.dangerLevel?r.DEFIN.dangerCallbackEvent:r.DEFIN.StableCallbackEvent),a.battery={level:e.viewLevel,charging:e.charging,dangerLevel:o.dangerLevel},this.$element.trigger(a)},r.prototype.option=function(e,r){if(void 0==e&&void 0==r)return this.options;if("object"==typeof e)t.extend(this.options,e);else{if("string"!=typeof e||void 0==this.options[e])return void console.warn("not supported option.",e,r);if(void 0==r)return this.options[e];this.options[e]=r}this.updateBattery(),this.updateBatteryStatus()},r.prototype.test=function(t,e){if(!this.options.test)return void console.log("disable test option. ",this.options.test);var r={};if("object"==typeof t)r=t;else{if("string"!=typeof t||void 0==this.testBatteryInfo[t])return void console.warn("not supported option.",t,e);r[t]=e}r.level&&(r.level=r.level/100),this.updateBatteryStatus(r)};var o=t.fn.pureBattery;t.fn.pureBattery=e,t.fn.pureBattery.Constructor=r,t.fn.pureBattery.noConflict=function(){return t.fn.pureBattery=o,this}}(jQuery);